local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Sir Doom",
    Icon = 0,
    LoadingTitle = "Sdoom",
    LoadingSubtitle = "by Doom",
    Theme = "Default",
    DisableRayfieldPrompts = false,
    DisableBuildWarnings = false,
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "lua Hub"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = false,
    KeySettings = {
        Title = "Untitled",
        Subtitle = "Key System",
        Note = "No method of obtaining the key is provided",
        FileName = "Key",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"Hello"}
    }
})

local Tab = Window:CreateTab("MainTab")
local Section = Tab:CreateSection("Main")

-- Global player list
local highlightEnabled = false  -- Başlangıçta highlight kapalı

-- GUI Elemanları (Roblox GUI)
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")  -- GUI'yi oyuncunun ekranına ekleyelim

-- Toggle ile highlight'ı açıp kapat
local Toggle = Tab:CreateToggle({
   Name = "Enable ESP",
   CurrentValue = false,
   Flag = "Toggle1", -- Konfigürasyon dosyasındaki flag
   Callback = function(Value)
      -- Toggle durumu değiştiğinde yapılacaklar
      highlightEnabled = Value
      print("ESP durumu: " .. (highlightEnabled and "Açık" or "Kapalı"))
      updateESP()  -- ESP'yi güncelle
   end,
})

-- ESP İşlevi: Oyuncuları highlight (ESP) ile göster
function drawESP(player)
    local character = player.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        local rootPart = character.HumanoidRootPart
        local screenPosition, onScreen = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("CoreGui"):FindFirstChild("WorldCamera"):WorldToViewportPoint(rootPart.Position)
        
        if onScreen then
            local espText = Instance.new("TextLabel")
            espText.Text = player.Name
            espText.Size = UDim2.new(0, 100, 0, 30)
            espText.Position = UDim2.new(0, screenPosition.X, 0, screenPosition.Y)
            espText.TextColor3 = highlightEnabled and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(0, 255, 0)  -- Vurgulama (Red / Green)
            espText.TextScaled = true
            espText.BackgroundTransparency = 1
            espText.Parent = game:GetService("CoreGui")
            
            -- Vurgulama etkinse, esp görünür, değilse gizlenir
            if not highlightEnabled then
                espText.Visible = false
            end
        end
    end
end

-- ESP'yi güncelle
function updateESP()
    -- Tüm oyuncuları kontrol et ve ESP'yi çiz
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Character then
            drawESP(player)
        end
    end
end

-- Oyuncu oyuna girdiğinde ESP'yi çiz
game.Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function(character)
        drawESP(player)
    end)
end)

-- Oyuncu oyundan çıktığında ESP'yi sil
game.Players.PlayerRemoving:Connect(function(player)
    -- Player karakteri mevcutsa ve ESP aktifse, ESP'yi sil
    local esp = game:GetService("CoreGui"):FindFirstChild(player.Name)
    if esp then
        esp:Destroy()
    end
end)

-- Başlangıçta mevcut oyuncuları ekle ve ESP'yi çiz
for _, player in pairs(game.Players:GetPlayers()) do
    if player.Character then
        drawESP(player)
    end
end


local highlightEnabled = false  -- Başlangıçta tracer kapalı

-- GUI Elemanları (Roblox GUI)
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")  -- GUI'yi oyuncunun ekranına ekleyelim

-- Toggle ile tracer'ı açıp kapat
local Toggle = Tab:CreateToggle({
   Name = "Enable Tracers",
   CurrentValue = false,
   Flag = "Toggle1", -- Konfigürasyon dosyasındaki flag
   Callback = function(Value)
      -- Toggle durumu değiştiğinde yapılacaklar
      highlightEnabled = Value
      print("Tracer durumu: " .. (highlightEnabled and "Açık" or "Kapalı"))
      updateTracers()  -- Tracer'ları güncelle
   end,
})

-- Tracer Çizme Fonksiyonu
function drawTracer(player)
    local character = player.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        local rootPart = character.HumanoidRootPart
        local screenPosition, onScreen = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("CoreGui"):FindFirstChild("WorldCamera"):WorldToViewportPoint(rootPart.Position)
        
        if onScreen and highlightEnabled then
            -- Tracer çizme
            local tracer = Instance.new("Frame")
            tracer.Size = UDim2.new(0, 2, 0, screenPosition.Y)
            tracer.Position = UDim2.new(0, screenPosition.X, 0, screenPosition.Y)
            tracer.BackgroundColor3 = Color3.fromRGB(0, 255, 0)  -- Tracer rengi
            tracer.BorderSizePixel = 0
            tracer.AnchorPoint = Vector2.new(0.5, 1)  -- Başlangıçta aşağıya doğru
            tracer.Parent = screenGui
            game:GetService("TweenService"):Create(tracer, TweenInfo.new(0.1), {Position = UDim2.new(0, screenPosition.X, 0, screenPosition.Y - 100)}):Play()  -- Yüksekliği 100 birim yukarı kaydır

            -- Tracer zamanla kaybolur (örnek: 1 saniye sonra)
            game:GetService("Debris"):AddItem(tracer, 1)  -- Tracer 1 saniye sonra silinir
        end
    end
end

-- Tracer'ları güncelle
function updateTracers()
    -- Mevcut oyuncuları kontrol et ve tracer'ları çiz
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Character then
            drawTracer(player)
        end
    end
end

-- Oyuncu oyuna girdiğinde tracer'ı çiz
game.Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function(character)
        if highlightEnabled then
            drawTracer(player)
        end
    end)
end)

-- Oyuncu oyundan çıktığında tracer'ı sil
game.Players.PlayerRemoving:Connect(function(player)
    -- Player karakteri mevcutsa ve tracer aktifse, tracer'ı sil
    -- Tracer'lar otomatik olarak 1 saniye sonra silinecek
end)

-- Başlangıçta mevcut oyuncuları ekle ve tracer'ı çiz
for _, player in pairs(game.Players:GetPlayers()) do
    if player.Character then
        drawTracer(player)
    end
end

-- Her saniye oyuncuları kontrol et ve tracer'ları güncelle
while true do
    wait(1)  -- Her saniye
    updateTracers()
end


Rayfield:LoadConfiguration()
